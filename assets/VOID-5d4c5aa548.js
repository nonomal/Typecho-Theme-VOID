function throttle(o,n,a){var m,i=new Date;return function(){var e=arguments,t=new Date;clearTimeout(m),a<=t-i?(o.apply(this,e),i=t):m=setTimeout(o,n)}}function checkGoTop(){$(document).scrollTop()>window.innerHeight?$("#back-top").fadeIn(300):$("#back-top").fadeOut(200)}console.log(" %c Theme VOID %c https://blog.imalan.cn/ ","color: #fadfa3; background: #23b7e5; padding:5px;","background: #1c2b36; padding:5px;");var VOID={init:function(){VOID.parseTOC(),VOID.showWelcomeWord(),VOID.parsePhotos(),VOID.parseUrl(),hljs.initHighlightingOnLoad(),VOID.hitokoto(),VOID.handleLike(),pangu.spacingElementByTagName("p"),$.bigfoot({actionOriginalFN:"ignore"}),$(".item,.board-item").on("touchstart",function(){$(this).addClass("hover")}),$(".item,.board-item").on("touchend",function(){$(this).removeClass("hover")}),VOIDConfig.fixHeader&&(70<$(document).scrollTop()?$("header,.mobile-search").addClass("dark"):$("main>.lazy-wrap").length&&$("header,.mobile-search").removeClass("dark")),checkGoTop(),VOIDConfig.lazyload&&window.addEventListener("scroll",throttle(VOID.lazyLoad,100,1e3)),AjaxComment.init(),VOIDConfig.infiniteLoad&&VOIDConfig.ajaxIndex&&window.addEventListener("scroll",function(){setTimeout(function(){var e=$(".footer-info").offset().top,t=$(document).scrollTop(),o=$(window).height();Math.ceil(o+t)>=e&&VOID.ajaxLoad()},750)})},showWelcomeWord:function(){if(""!=VOIDConfig.customNotice&&setTimeout(function(){alert(VOIDConfig.customNotice,4e3)},200),VOIDConfig.welcomeWord){var e="";if(""!==document.referrer){var t=document.createElement("a");t.href=document.referrer,e="嗨！来自 "+t.hostname+" 的朋友！";var o=t.hostname.split(".")[1];"baidu"==o?e="嗨！ 来自 百度搜索 的朋友！":"so"==o?e="嗨！ 来自 360搜索 的朋友！":"google"==o&&(e="嗨！ 来自 谷歌搜索 的朋友！")}var n=(new Date).getHours();23<n||n<=5?e+="你是夜猫子呀？这么晚还不睡觉，明天起的来嘛？":5<n&&n<=7?e+="早上好！一日之计在于晨，美好的一天就要开始了！":7<n&&n<=11?e+="上午好！工作顺利嘛，不要久坐，多起来走动走动哦！":11<n&&n<=14?e+="中午了，工作了一个上午，现在是午餐时间！":14<n&&n<=17?e+="午后很容易犯困呢，今天的运动目标完成了吗？":17<n&&n<=19?e+="傍晚了！窗外夕阳的景色很美丽呢，最美不过夕阳红~":19<n&&n<=21?e+="晚上好，今天过得怎么样？":21<n&&n<=23&&(e+="已经这么晚了呀，早点休息吧，晚安~"),setTimeout(function(){alert(e)},200)}},parsePhotos:function(){$.each($(".photos"),function(e,t){$.each($(t).children(),function(e,o){var n=new Image;n.src=$(o).find("img").attr("data-src"),n.onload=function(){var e=parseFloat(n.width),t=parseFloat(n.height);$(o).css("width",50*e/t+"px"),$(o).css("flex-grow",50*e/t),$(o).find("a").css("padding-top",t/e*100+"%")}})})},parseUrl:function(){var o=document.domain;$('a:not(a[href^="#"]):not(".post-like")').each(function(e,t){(!$(t).attr("target")||""==!$(t).attr("target")&&"_self"==!$(t).attr("target"))&&t.host!=o&&$(t).attr("target","_blank")}),VOIDConfig.PJAX&&($.each($('a:not(a[target="_blank"], a[no-pjax])'),function(e,t){t.host==o&&$(t).addClass("pjax")}),$(document).pjax("a.pjax",{container:"#pjax-container",fragment:"#pjax-container",timeout:8e3}))},hitokoto:function(){$.ajax({url:"https://v1.hitokoto.cn/?c=a&encode=json",async:!0,success:function(e){$("#hitokoto").html(e.hitokoto+" - 「"+e.from+"」")}})},beforePjax:function(){NProgress.start(),$(".toggle").removeClass("pushed"),$(".mobile-search").removeClass("opened"),$("header").removeClass("opened"),$("body").hasClass("modal-open")&&VOID.closeModal(),$("#nav-mobile").fadeOut(200),0<$(".TOC").length&&tocbot.destroy()},alert:function(e,t){var o=(new Date).getTime();$("body").prepend('<div class="msg" id="msg{id}">{Text}</div>'.replace("{Text}",e).replace("{id}",o)),$.each($(".msg"),function(e,t){$(t).attr("id")!="msg"+o&&$(t).css("top",$(t).offset().top-$(document).scrollTop()+$(".msg#msg"+o).outerHeight()+20+"px")}),$(".msg#msg"+o).addClass("show");var n=t;"number"!=typeof n&&(n=2500),setTimeout(function(){$(".msg#msg"+o).addClass("hide"),setTimeout(function(){$(".msg#msg"+o).remove()},1e3)},n)},handleLike:function(){if(0<$(".post-like").length){var n=$.macaroon("_syan_like")||"";$.each($(".post-like"),function(e,t){var o=$(t).attr("data-pid");-1!==n.indexOf(","+o+",")&&$(t).addClass("done")}),$(".post-like").click(function(){$(this).addClass("done")})}0<$(".post-like").length&&($(".post-like").unbind("click"),$(".post-like").click(function(){$(this).addClass("done");var t=$(this),e=t.attr("data-pid"),o=$.macaroon("_syan_like")||"";if(e&&/^\d{1,10}$/.test(e)){if(-1!==o.indexOf(","+e+","))return alert("您已经赞过了！");o?160<=o.length?((o=(o=o.substring(0,o.length-1)).substr(1).split(",")).splice(0,1),o.push(e),o=o.join(","),$.macaroon("_syan_like",","+o+",")):$.macaroon("_syan_like",o+e+","):$.macaroon("_syan_like",","+e+","),$.post(likePath,{cid:e},function(){t.addClass("actived");var e=t.find(".like-num").text();t.find(".like-num").text(parseInt(e)+1)},"json")}}))},afterPjax:function(){NProgress.done(),VOID.parseTOC(),VOID.parsePhotos(),VOID.parseUrl(),VOID.reload(),VOID.handleLike(),AjaxComment.init(),VOIDConfig.welcomeWord&&alert("欢迎访问 "+document.title),$("a.next").length&&(VOIDConfig.nextUrl=$("a.next").attr("href"),$("a.next").remove()),VOIDConfig.fixHeader&&($("main>.lazy-wrap").length?$("header").removeClass("dark"):$("header").addClass("dark")),checkGoTop()},reload:function(){$("pre code").each(function(e,t){hljs.highlightBlock(t)}),"undefined"!=typeof MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub]),"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",location.pathname+location.search]),pangu.spacingElementByTagName("p"),getSocial(),$(".board-item").on("touchstart",function(){$(this).addClass("hover")}),$(".board-item").on("touchend",function(){$(this).removeClass("hover")}),$.bigfoot({actionOriginalFN:"ignore"}),0<$(".OwO").length&&new OwO({logo:"OωO",container:document.getElementsByClassName("OwO")[0],target:document.getElementsByClassName("input-area")[0],api:"/usr/themes/VOID/assets/libs/owo/OwO_01.json",position:"down",width:"400px",maxHeight:"250px"})},scrollTop:0,openModal:function(){VOID.scrollTop=document.scrollingElement.scrollTop,document.body.classList.add("modal-open"),document.body.style.top=-VOID.scrollTop+"px"},closeModal:function(){document.body.classList.remove("modal-open"),document.scrollingElement.scrollTop=VOID.scrollTop},toggleArchive:function(e){$(e).parent().hasClass("shrink")?($(e).html("-"),$(e).parent().removeClass("shrink")):($(e).html("+"),$(e).parent().addClass("shrink"))},parseTOC:function(){if(0<$(".TOC").length){tocbot.init({tocSelector:".TOC",contentSelector:"div[itemprop=articleBody]",headingSelector:"h2, h3, h4, h5",collapseDepth:6})}},isAjaxLoading:!1,ajaxLoad:function(){if(!VOID.isAjaxLoading&&-2!=VOIDConfig.nextUrl){if(-1==VOIDConfig.nextUrl){if(!$("a.next").length)return $("a.ajax-Load").parent().html("这里是世界的尽头"),void(VOIDConfig.nextUrl=-2);VOIDConfig.nextUrl=$("a.next").attr("href"),$("a.next").remove()}$("a.ajax-Load").html("加载中..."),VOID.isAjaxLoading=!0,$.ajax({url:VOIDConfig.nextUrl,type:"get",beforeSend:function(e){e.setRequestHeader("X-VOID-AJAX","true")},success:function(e){$(e).find("a.next").length?(VOIDConfig.nextUrl=$(e).find("a.next").attr("href"),$("a.ajax-Load").html("加载更多")):($("a.ajax-Load").parent().removeClass("current"),$("a.ajax-Load").parent().html("这里是世界的尽头"),VOIDConfig.nextUrl=-2),$("#post-list").append($(e).find("a.item")),$("a.item.ajax:not(.ajax-loaded)").addClass("ajax-loaded"),VOID.isAjaxLoading=!1,VOID.parseUrl(),$(".item,.board-item").on("touchstart",function(){$(this).addClass("hover")}),$(".item,.board-item").on("touchend",function(){$(this).removeClass("hover")})},error:function(){VOID.isAjaxLoading=!1,alert("加载失败！请检查网络或者联系博主。"),$("a.ajax-Load").html("加载更多")}})}},lazyLoad:function(){var n=document.documentElement.clientHeight,a=document.documentElement.scrollTop||document.body.scrollTop;$.each($("img.lazyload"),function(e,t){if($(t).offset().top<n+a&&$(t).offset().top+$(t).height()>a&&!$(t).hasClass("loaded")&&!$(t).hasClass("error")){var o=new Image;o.src=$(t).attr("data-src"),o.onload=function(){$(t).animate({opacity:0},150),setTimeout(function(){$(t).attr("src",$(t).attr("data-src")),$(t).addClass("loaded"),$(t).animate({opacity:1},180)},180)},o.onerror=function(){$(t).addClass("error")}}})}},AjaxComment={noName:"必须填写用户名",noMail:"必须填写电子邮箱地址",noContent:"必须填写评论内容",invalidMail:"邮箱地址不合法",commentsOrder:"DESC",commentList:".comment-list",comments:"#comments .comments-title",commentReply:".comment-reply",commentForm:"#comment-form",respond:".respond",textarea:"#textarea",submitBtn:"#comment-submit-button",newID:"",parentID:"",bindClick:function(){$(AjaxComment.commentReply+" a, #cancel-comment-reply-link").unbind("click"),$(AjaxComment.commentReply+" a").click(function(){AjaxComment.parentID=$(this).parent().parent().parent().attr("id"),$(AjaxComment.textarea).focus()}),$("#cancel-comment-reply-link").click(function(){AjaxComment.parentID=""})},err:function(){$(AjaxComment.submitBtn).attr("disabled",!1),AjaxComment.newID=""},finish:function(){(TypechoComment.cancelReply(),$(AjaxComment.submitBtn).html("提交评论"),$(AjaxComment.textarea).val(""),$(AjaxComment.submitBtn).attr("disabled",!1),0<$("#comment-"+AjaxComment.newID).length)&&((window.opera?"CSS1Compat"==document.compatMode?$("html"):$("body"):$("html,body")).animate({scrollTop:$("#comment-"+AjaxComment.newID).offset().top-50},500),$("#comment-"+AjaxComment.newID).fadeTo(500,1));$(".comment-num .num").html(parseInt($(".comment-num .num").html())+1),AjaxComment.bindClick()},init:function(){AjaxComment.bindClick(),$(AjaxComment.commentForm).submit(function(){if($(AjaxComment.submitBtn).attr("disabled",!0),$(AjaxComment.commentForm).find("#author")[0]){if(""==$(AjaxComment.commentForm).find("#author").val())return alert(AjaxComment.noName),AjaxComment.err(),!1;if(""==$(AjaxComment.commentForm).find("#mail").val())return alert(AjaxComment.noMail),AjaxComment.err(),!1;if(!/^[^@\s<&>]+@([a-z0-9]+\.)+[a-z]{2,4}$/i.test($(AjaxComment.commentForm).find("#mail").val()))return alert(AjaxComment.invalidMail),AjaxComment.err(),!1}var e=$(AjaxComment.commentForm).find(AjaxComment.textarea).val().replace(/(^\s*)|(\s*$)/g,"");return null==e||""==e?(alert(AjaxComment.noContent),AjaxComment.err()):($(AjaxComment.submitBtn).html("提交中"),$.ajax({url:$(AjaxComment.commentForm).attr("action"),type:$(AjaxComment.commentForm).attr("method"),data:$(AjaxComment.commentForm).serializeArray(),error:function(){return alert("提交失败！请重试。"),$(AjaxComment.submitBtn).html("提交评论"),AjaxComment.err(),!1},success:function(e){try{if($(AjaxComment.commentList,e).length){if(AjaxComment.newID=$(AjaxComment.commentList,e).html().match(/id="?comment-\d+/g).join().match(/\d+/g).sort(function(e,t){return e-t}).pop(),$(".pager .prev").length&&""==AjaxComment.parentID)return alert("评论成功！请回到评论第一页查看。"),AjaxComment.newID="",AjaxComment.parentID="",AjaxComment.finish(),!1;var t=""==AjaxComment.parentID?"comment-parent":"comment-child",o='<div itemscope itemtype="http://schema.org/UserComments" id="comment-'+AjaxComment.newID+'" style="opacity:0" class="comment-body '+t+'">'+$(e).find("#comment-"+AjaxComment.newID).html()+"</div>";return $(AjaxComment.commentList).length<=0&&$("#comments").append('<h3 class="comment-separator"><div class="comment-tab-current"><span class="comment-num">已有 <span class="num">0</span> 条评论</span></div></h3>').append('<div class="comment-list"></div>'),""==AjaxComment.parentID?($("#comments>.comment-list").prepend(o),alert("评论成功！"),AjaxComment.finish()):($("#"+AjaxComment.parentID).hasClass("comment-parent")?0<$("#"+AjaxComment.parentID+" > .comment-children").length?$("#"+AjaxComment.parentID+" > .comment-children > .comment-list").prepend(o):(o='<div class="comment-children"><div class="comment-list">'+o+"</div></div>",$("#"+AjaxComment.parentID).append(o)):$("#"+AjaxComment.parentID).after(o),alert("评论成功！"),AjaxComment.finish(),AjaxComment.parentID=""),AjaxComment.newID="",!1}var n="提交失败！请重试。"+$($(e)[7]).text();return alert(n),$(AjaxComment.submitBtn).html("提交评论"),AjaxComment.err(),!1}catch(e){window.location.reload()}}})),!1})}};function startSearch(e){var t=$(e).val();if($(e).val(""),$(e).blur(),t&&""!=t){var o=VOIDConfig.searchBase+t;VOIDConfig.PJAX?$.pjax({url:o,container:"#pjax-container",fragment:"#pjax-container",timeout:8e3}):window.open(o,"_self")}else $(e).attr("placeholder","你还没有输入任何信息")}function enterSearch(e){13==(window.event||arguments.callee.caller.arguments[0]).keyCode&&startSearch(e)}function toggleSearch(){$(".mobile-search").toggleClass("opened"),setTimeout(function(){$(".mobile-search").hasClass("opened")?$(".mobile-search input").focus():$(".mobile-search input").blur()},400)}function toggleNav(e){$(e).toggleClass("pushed"),$("header").toggleClass("opened"),$(e).hasClass("pushed")?($("#nav-mobile").fadeIn(200),VOID.openModal()):(VOID.closeModal(),$("#nav-mobile").fadeOut(200))}function toggleToc(e){$(".TOC").toggleClass("show"),$(".toggle-toc").toggleClass("pushed"),$(e).toggleClass("pushed")}function goTop(e){(window.opera?"CSS1Compat"==document.compatMode?$("html"):$("body"):$("html,body")).animate({scrollTop:0},e)}$(document).ready(function(){window.alert=VOID.alert,VOID.init()}),VOIDConfig.PJAX&&($(document).on("pjax:send",function(){VOID.beforePjax()}),$(document).on("pjax:complete",function(){VOID.afterPjax()})),setInterval(function(){var e=(new Date).getTime()-Date.parse(VOIDConfig.buildTime);e=Math.floor(e/1e3);var t=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var n=Math.floor(e/60);e%=60;var a=Math.floor(e/1);$("#uptime").html(t+" 天 "+o+" 小时 "+n+" 分 "+a+" 秒 ")},1e3),window.addEventListener("scroll",function(){VOIDConfig.fixHeader&&(70<=$(document).scrollTop()?$("header,.mobile-search").addClass("dark"):$("main>.lazy-wrap").length&&$("header,.mobile-search").removeClass("dark")),checkGoTop()});